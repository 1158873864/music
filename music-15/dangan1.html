<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>档案</title>
    <link rel="stylesheet" href="css/bootstrap.css">
    <link rel="stylesheet" href="css/main.css"/>
    <link rel="stylesheet" href="iconfont/iconfont.css"/>
    <script src="js/jquery.1.7.2.min.js"></script>
    <script type="text/javascript" src="jedate/jedate.js" ></script>
    <script src="js/html2canvas.js"></script>
    <script src="js/jspdf.min.js"></script>
    <script src="js/main.js"></script>
    <script src="js/echarts.min.js"></script>
    <style>
        table tr td:nth-child(2n-1){
            color: #333;
            font-weight: bold;
        }
        @media only screen and (orientation:portrait) {
            
        }
    </style>
</head>
<body>
<div id="pdf1">
<!--主体-->
<div class="container" style="height: 100%;padding-bottom: 30px;">
 <div class="dangan_content danganr">
     <div class="titledangan">情绪宣泄测试报告</div>
     <div class="panel panel-warning" style="margin-top:22px" >
         <div class="panel-heading bg-warning">人员信息 </div>
         <div class="panel-body">
             <form action="" class="table-responsive">
                 <table class="table table-bordered">
                     <tbody>
                     <tr>
                         <td>编号</td>
                         <td id="number"></td>
                         <td>姓名</td>
                         <td id="name"></td>
                         <td>性别</td>
                         <td id="sex"></td>
                     </tr>
                     <tr>
                         <td>出生日期</td>
                         <td id="date"></td>
                         <td>学历</td>
                         <td id="xueli"></td>
                         <td>民族</td>
                         <td id="minzu"></td>
                     </tr>
                     </tbody>
                 </table>
             </form>
         </div>
     </div>
     <div class="panel " >
         <div class="panel-heading ">压力介绍 </div>
         <div class="panel-body">
             <p>
                 心理压力是个体在生活适应过程中的一种身心紧张状态，源于环境要求与自身应对能力不平衡；这种紧张状态倾向于通过非特异的心理和生理反应表现出来。
             </p>
             <p>
                 压力是压力源和压力反应共同构成的一种认知和行为体验。人的内心冲突及与之相伴随的情绪体验是心理学意义上的压力。从心理学角度看，压力是外部事件引发的一种内心体验。
                 完全没有心理压力的情况是不存在的。我们假定有这样的情形，那一定比有巨大心理压力的情景更可怕。换一种说法就是，没有压力本身就是一种压力，它的名字叫作空虚。无数的文学艺术作品描述过这种空虚感。那是一种比死亡更没有生气的状况，一种活着却感觉不到自己在活着的巨大悲哀。

             </p>
         </div>
     </div>
     <div class="panel">
         <div class="panel-heading">
             击打分值表：
         </div>
         <div class="panel-body">
             <div class="row">
                 <div class="col-md-6" style="height: 200px" id="eChart1">

                 </div>
                 <div class="col-md-6"  style="height: 200px" id="eChart2">

                 </div>
             </div>
         </div>
     </div>
     <div class="panel " >
         <div class="panel-heading ">压力测试结果 </div>
         <div class="panel-body">
             <p id="qResult">

             </p>
         </div>
     </div>

     <div class="panel panel-warning">
         <div class="panel-heading bg-warning">本次宣泄结果:</div>
         <div class="panel-body">
             <ul class="list-group" >
                 <li class="list-group-item ">
                     <div class="row">
                         <div class="col-md-6">
                             <dl class="dl-horizontal">
                                 <dt>击打次数：</dt>
                                 <dd id="jidatime">10</dd>
                             </dl>
                         </div>
                         <div class="col-md-6">
                             <dl class="dl-horizontal ">
                                 <dt>宣泄次数：</dt>
                                 <dd id="xuanxietime">10次</dd>
                             </dl>
                         </div>
                     </div>
                 </li>
                 <li class="list-group-item">
                     <dl class="dl-horizontal">
                         <dt>宣泄结果：</dt>
                         <dd id="result">此次宣泄结果不是很成功，请再次击打呐喊宣泄。您必须以积极的心理适应环境，增强个体在社会中的适应性；也要分析自我的性格特点，从而更好的认识自我，提高自我，生活本身就是一个学习的过程，相信自己，请加油！</dd>
                     </dl>
                 </li>
                 <li class="list-group-item">
                     <dl class="dl-horizontal">
                         <dt>指导建议：</dt>
                         <dd id="suggest">培养积极的心态是应对压力的良方，即使你现在不尽如意，你还是应该把握住机会，在历史的面前，做到尽吾志，莫道错过的时候，才后悔万分，这样的人生，必定是失败和苍白的人生。每个人都知道心态很重要，但更重要的是要明白如何调节心态，积极地调集能动性，改善心境，调整心态，改善自身状态，这样才能以自变（改变自我），而应万变拥有良好和积极的心态再配以良方技巧一定能够解决，人生赢家赢在明天！</dd>
                     </dl>
                 </li>

             </ul>
         </div>
     </div>
     <div class="panel " >
         <div class="panel-heading ">解决压力的方法 </div>
         <div class="panel-body">
             <p>1、注重过程淡化功利法</p>
             <p>建立合理的、客观的自我期望值，奋斗目标要合理，有时做事可往最坏处着想，但向最好处努力。</p>
             <p>2、换位思考认同法</p>
             <p>正确认知压力，灵活调整自己的心态。例如，当你遇到不公平的事情、不协调的人际关系、不愉快的情感体验时，试试换位思考。</p>
             <p>3、音乐与生理保健法</p>
             <p>各种声音通过耳朵被人感受，如他人的赞扬声、指责声、议论声等都会影响你的心态，因此，你可以多听些优美的音乐，缓解不愉快的心情。养成良好的生活与自我保健行为习惯极为重要，同时，创造和谐的家庭氛围更不容忽视。</p>
             <p>4、推移时间遗忘法</p>
             <p>时间是解决问题的最好办法，积极忘记过去的、眼前的不愉快，随时修正自己的认知观念，不要让痛苦的过去牵制住你的未来。</p>
             <p>5、自信自主激励法</p>
             <p>即相信自己是最好的、最可以依赖的，每桩伟业都由自信开始。</p>
             <p>6、顺其自然自我解脱法</p>
             <p>学会自我放松，在适当的情况下，找信得过的人想说便说;想休息便休息;想娱乐便娱乐，实在不想做事时可暂时放下，可以追求卓越，但无需求十全十美。</p>
         </div>
     </div>
     <div class="panel panel-default">
         <div class="panel-heading">上次宣泄结果:</div>
         <div class="panel-body">
             <ul class="list-group" >
                 <li class="list-group-item ">
                     <div class="row">
                         <div class="col-md-6">
                             <dl class="dl-horizontal">
                                 <dt>击打次数：</dt>
                                 <dd id="lastjidacishu">10次</dd>
                             </dl>
                         </div>
                         <div class="col-md-6">
                             <dl class="dl-horizontal ">
                                 <dt>宣泄次数：</dt>
                                 <dd id="lastxuanxiecishu">10次</dd>
                             </dl>
                         </div>
                     </div>
                 </li>
                 <li class="list-group-item">
                     <dl class="dl-horizontal">
                         <dt>宣泄结果：</dt>
                         <dd id="lastresult">此次宣泄结果非常成功，在工作、生活、学习中，或多或少都会遇到这样那样问题，不顺心或不愉快，请不要将各种压力因素长久的压在内心里，找亲人朋友倾述或找个自己热爱的运动去放松一下。这样，我们才能以更好的心态去工作生活学习！</dd>
                     </dl>
                 </li>
                 <li class="list-group-item">
                     <dl class="dl-horizontal">
                         <dt>指导建议：</dt>
                         <dd id="lastsuggest">通过宣泄，内心的压力释放了很多，你很棒，也很勇敢，大多数人都想改变这个世界，但没有想改变自己。”有时候,我们改变不了我们周围的环境,可是我们却可以改变自己,改变自己看待周围环境的心态以及目光,“你周围的人如此和蔼，你周围的环境是如此的美丽，你有如此优点和能力去适应新环境。”整理自己的心情，到了那个那时候,你会发现其实身边每一样事物看上去都是那么美好,那么环境不就是已经改变了，不是吗?</dd>
                     </dl>
                 </li>

             </ul>
         </div>
     </div>
     <div class="row">
         <div class="col-md-2 wq_title" style="">往期宣泄结果：</div>
         <div class="col-md-4">
             <div class="input-group input-group-lg" >
             <button class="btn btn-default btn-warning" type="button" onclick="window.location.href='dangan2.html'">查看</button>
      </span>
             </div><!-- /input-group -->
         </div>
         <div class="col-md-6 text-right">
             <button type="button" class="btn btn-lg btn-default " onclick="daochu()"> <i class="iconfont icon-xiazai"></i> 导出</button>
         </div>
     </div>
     <div style="text-align: center; margin-top: 20px;"   >
         <a href="javascript:history.go(-1)" class="btn btn-lg btn-danger"> <i class="iconfont icon-tuichu"></i> 返回</a>
     </div>

</div>
</div>
<span class="close">&times;</span>
<script type="text/javascript">
    // 第一个

    var number="";
    var name="";
    var sex="";
    var date="";
    var xueli="";
    var minzu="";
    var youxiu=333;
    var lianghao=245;
    var hege=231;
    var buhege=145;
    var jidayouxiu=11;
    var jidahege=6;
    var jidabuhege=2;
    var nahanyouxiu=4;
    var nahanhege=3;
    var nahanbuhege=5;
    var jidanahanyouxiu=4;
    var jidanahanhege=8;
    var jidanahanbuhege=5;
    var yongbaoyouxiu=5;
    var yongbaohege=9;
    var yongbaobuhege=2;
    var qResult="";
    var jidacishu=50;
    var xuanxiecishu=40;
    var result;
    var suggest;
    var xuanxiedate;
    var list=new Array();
    $.get("php/getxuanxie.php" ,function (d){
        var temp = d.split("\n");
        var temp1 = temp[temp.length - 1];
        var questionlist = temp1.split("....");
        for (var i = 0; i < questionlist.length - 1; i++) {
            var question = questionlist[i].split(",,,");
            list.push(question);
        }
        var len=list.length;
        if(len>1){
            document.getElementById("lastjidacishu").innerText=list[len-2][24];
            document.getElementById("lastxuanxiecishu").innerText=list[len-2][25];
            document.getElementById("lastresult").innerText=list[len-2][26];
            document.getElementById("lastsuggest").innerText=list[len-2][27];
        }
        number=list[len-1][1];
        name=list[len-1][2];
        sex=list[len-1][3];
        date=list[len-1][4];
        xueli=list[len-1][5];
        minzu=list[len-1][6];
        youxiu=list[len-1][7];
        lianghao=list[len-1][8];
        hege=list[len-1][9];
        buhege=list[len-1][10];
        jidayouxiu=list[len-1][11];
        jidahege=list[len-1][12];
        jidabuhege=list[len-1][13];
        nahanyouxiu=list[len-1][14];
        nahanhege=list[len-1][15];
        nahanbuhege=list[len-1][16];
        jidanahanyouxiu=list[len-1][17];
        jidanahanhege=list[len-1][18];
        jidanahanbuhege=list[len-1][19];
        yongbaoyouxiu=list[len-1][20];
        yongbaohege=list[len-1][21];
        yongbaobuhege=list[len-1][22];
        qResult=list[len-1][23];
        jidacishu=list[len-1][24];
        xuanxiecishu=list[len-1][25];
        result=list[len-1][26];
        suggest=list[len-1][27];
        document.getElementById("jidatime").innerText=jidacishu;
        document.getElementById("xuanxietime").innerText=xuanxiecishu;
        document.getElementById("result").innerText=result;
        document.getElementById("suggest").innerText=suggest;
        document.getElementById("number").innerText=number;
        document.getElementById("name").innerText=name;
        document.getElementById("date").innerText=date;
        document.getElementById("sex").innerText=sex;
        document.getElementById("xueli").innerText=xueli;
        document.getElementById("minzu").innerText=minzu;
        document.getElementById("qResult").innerText=qResult;

        var myChart1 = echarts.init(document.getElementById('eChart1'));
        var    data=[
            {value:youxiu, name:'优秀'},
            {value:lianghao, name:'良好'},
            {value:hege, name:'合格'},
            {value:buhege, name:'不合格'},
        ];

        var totalN=0;

        for(var i=0;i<data.length;i++){
            totalN+=data[i].value;
        }

        option1 = {
            /*   title : {
             text: '同名数量统计',
             subtext: '纯属虚构',
             x:'center'
             },*/
            tooltip : {
                trigger: 'item',
                formatter: "{a} <br/>{b} : {c} ({d}%)"
            },
            legend: {
                orient: 'vertical',
                left: 'right',
                top:'40%',
                textStyle:{
                    fontSize:12
                },
                data: ['优秀',
                    '良好',
                    '合格',
                    '不合格',],
            },
            // xAxis:{
            //     nameTextStyle:{
            //        fontSize:'34',
            //     }
            // },
            series : [
                {
                    name: '访问来源',
                    type: 'pie',
                    radius : '60%',
                    center: ['50%', '50%'],
                    data:[{value:youxiu, name:'优秀'},
                        {value:lianghao, name:'良好'},
                        {value:hege, name:'合格'},
                        {value:buhege, name:'不合格',},
                    ],
                    itemStyle: {
                        emphasis: {
                            shadowBlur: 10,
                            shadowOffsetX: 0,
                            shadowColor: 'rgba(0, 0, 0, 0.5)'
                        },
                        normal: {
                            color: function(params) {
                                // build a color map as your need.
                                var colorList = [
                                    '#FD6F17','#33E37D','#04B9DF','#EAD700'
                                ];
                                return colorList[params.dataIndex]
                            }
                        }
                    },
                    labelLine: {
                        normal: {
                            smooth: 0.4,

                        }
                    },
                    label: {
                        normal: {
                            textStyle: {

                                fontSize:'12',

                            }
                        }
                    },
                }
            ]
        };
        myChart1.setOption(option1);

        //    第二个
        var myChart2 = echarts.init(document.getElementById('eChart2'));
        option2 = {
            /*  title : {
                  text: '某地区蒸发量和降水量',
                  subtext: '纯属虚构'
              },*/
            tooltip : {
                trigger: 'axis'
            },
            legend: {
                data:['数据一','数据二','数据三']
            },

            calculable : true,
            xAxis : [
                {
                    type : 'category',
                    data : ['击打','呐喊','击打呐喊','拥抱']
                }
            ],
            yAxis : [
                {
                    type : 'value'
                }
            ],
            series : [
                {
                    name:'优秀',
                    type:'bar',
                    data:[jidayouxiu, nahanyouxiu, jidanahanyouxiu, yongbaoyouxiu],
                },
                {
                    name:'合格',
                    type:'bar',
                    data:[jidahege,nahanhege,jidanahanhege,yongbaohege],
                },
                {
                    name:'不合格',
                    type:'bar',
                    data:[jidabuhege,nahanbuhege,jidanahanbuhege,yongbaobuhege],
                },
            ]
        };
        myChart2.setOption(option2);
    })

    function daochu(){
        /*复制元素，注意ID*/
        window.location.href="#";
        $("body").append('<div id="pdf1">…………………………………………………………</div>');
        /*设置新元素样式*/
        $("#pdf1").css({
            "background-color": "#fff",
            "position": "absolute",
            "top": "0px",
            "z-index": "-1",
            "height": $("#pdf1").height()
        });
        /*html2canvas生成图片，jspdf生成PDF文件*/
        html2canvas($("#pdf1"), {
            background: "#fff",
            allowTaint: true,
            taintTest: false,
            onrendered:function(canvas) {
                var contentWidth = canvas.width;
                var contentHeight = canvas.height;
                var pageHeight = contentWidth / 592.28 * 841.89;
                var leftHeight = contentHeight;
                var position = 0;
                var imgWidth = 595.28;
                var imgHeight = 592.28/contentWidth * contentHeight;
                var pageData = canvas.toDataURL('image/jpeg', 1.0);
                var img = new Image();
                img.src = pageData;
                var pdf = new jsPDF('p', 'pt', 'a4');
                img.onload = function() {
                    if (leftHeight < pageHeight) {
                        pdf.addImage(pageData, 'JPEG', 0, 0, imgWidth, imgHeight );
                    } else {
                        while(leftHeight > 0) {
                            pdf.addImage(pageData, 'JPEG', 0, position, imgWidth, imgHeight)
                            leftHeight -= pageHeight;
                            position -= 841.89;
                            if(leftHeight > 0) {
                                pdf.addPage();
                            }
                        }
                    }
                    pdf.save(new Date().getTime() + '宣泄结果.pdf');
                    $("#pdf1").remove();
                    window.location.href="dangan1.html";
                }
            },
        })
    }



    $.get("php/getmessage.php" ,async =false,function (data){
        var temp=data.split("\n");
        var temp1=temp[temp.length-1];
        var q=temp1.split("...");
        document.getElementById("title").innerText=q[0];
    })



    function inittheme(id){
        if(id==0){
            $("body").css({
                "background":'url(../record/background/background.jpg) no-repeat',
                "background-size":"cover",
                "background-position":"center center",
            });
        }
        else {
            $("body").css({
                "background": 'url(images/bg_' + id + '.jpg) no-repeat',
                "background-size": "cover",
                "background-position": "center center",
            });
        }
    }
    var storage=window.localStorage;
    if(storage['has']=='yes'){
        $.get("php/getbackground.php",function (data) {
            var temp = data.split("\n");
            var temp1 = temp[temp.length - 1];
            inittheme(parseInt(temp1));
        })
    }
    else{
        $.get("php/getmessage.php" ,async =false,function (data){
            var temp=data.split("\n");
            var temp1=temp[temp.length-1];
            var q=temp1.split("...");
            $("body").css({
                "background": 'url(../' + q[3] + ') no-repeat',
                "background-size": "cover",
                "background-position": "center center",
            });
        })
    }
    $.get("php/getmessage.php" ,async =false,function (data){
        var temp=data.split("\n");
        var temp1=temp[temp.length-1];
        var q=temp1.split("...");
        document.getElementById("title").innerText=q[0];
        document.getElementById("t2").innerText=q[0];
        $("body").css({
            "background": 'url(../' + q[3] + ') no-repeat',
            "background-size": "cover",
            "background-position": "center center",
        });
    })
</script>
</div>
</body>
</html>
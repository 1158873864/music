<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>宣泄结果</title>
    <link rel="stylesheet" href="css/bootstrap.css">
    <link rel="stylesheet" href="css/main.css"/>
    <link rel="stylesheet" href="iconfont/iconfont.css"/>
    <script src="js/jquery.1.7.2.min.js"></script>
    <script type="text/javascript" src="jedate/jedate.js" ></script>
    <script src="js/main.js"></script>
    <script src="js/echarts.min.js"></script>
    <script src="js/html2canvas.js"></script>
    <script src="js/jspdf.min.js"></script>
    <style>
        table tr td:nth-child(2n-1){
            color: #333;
            font-weight: bold;
        }
    </style>
</head>
<body>

<div id="pdf1">
<!--主体-->
<div class="container" style="height: 100%;padding-bottom: 30px;">
 <div class="dangan_content danganr">

 	<div class="titledangan">情绪宣泄结果</div>
     <div class="panel panel-warning" style="margin-top:22px" >
         <div class="panel-heading bg-warning">人员信息 </div>
         <div class="panel-body">
             <form action="" class="table-responsive">
                 <table class="table table-bordered">
                     <tbody>
                     <tr>
                         <td>编号</td>
                         <td id="number"></td>
                         <td>姓名</td>
                         <td id="name"></td>
                         <td>性别</td>
                         <td id="sex"></td>
                     </tr>
                     <tr>
                         <td>出生日期</td>
                         <td id="date"></td>
                         <td>学历</td>
                         <td id="xueli"></td>
                         <td>民族</td>
                         <td id="minzu"></td>
                     </tr>
                     </tbody>
                 </table>
             </form>
         </div>
     </div>
     <div class="panel " >
         <div class="panel-heading ">压力介绍 </div>
         <div class="panel-body">
           <p>
               心理压力是个体在生活适应过程中的一种身心紧张状态，源于环境要求与自身应对能力不平衡；这种紧张状态倾向于通过非特异的心理和生理反应表现出来。
           </p>
             <p>
                 压力是压力源和压力反应共同构成的一种认知和行为体验。人的内心冲突及与之相伴随的情绪体验是心理学意义上的压力。从心理学角度看，压力是外部事件引发的一种内心体验。
                 完全没有心理压力的情况是不存在的。我们假定有这样的情形，那一定比有巨大心理压力的情景更可怕。换一种说法就是，没有压力本身就是一种压力，它的名字叫作空虚。无数的文学艺术作品描述过这种空虚感。那是一种比死亡更没有生气的状况，一种活着却感觉不到自己在活着的巨大悲哀。

             </p>
         </div>
     </div>
    <div class="panel">
        <div class="panel-heading">
            击打分值表：
        </div>
        <div class="panel-body">
            <div class="row">
                <div class="col-md-6" style="height: 200px" id="eChart1">

                </div>
                <div class="col-md-6"  style="height: 200px" id="eChart2">

                </div>
            </div>
        </div>
    </div>
    <div class="panel " >
         <div class="panel-heading ">压力测试结果 </div>
         <div class="panel-body">
           <p id="qResult">

           </p>
         </div>
     </div>
 
 <div class="panel panel-warning">
         <div class="panel-heading bg-warning">本次宣泄结果:</div>
         <div class="panel-body">
             <ul class="list-group" >
                 <li class="list-group-item ">
                     <div class="row">
                         <div class="col-md-6">
                             <dl class="dl-horizontal">
                                 <dt>击打次数：</dt>
                                 <dd id="jidatime">10</dd>
                             </dl>
                         </div>
                         <div class="col-md-6">
                             <dl class="dl-horizontal ">
                                 <dt>宣泄次数：</dt>
                                 <dd id="xuanxietime">10次</dd>
                             </dl>
                         </div>
                     </div>
                 </li>
                 <li class="list-group-item">
                     <dl class="dl-horizontal">
                         <dt>宣泄结果：</dt>
                         <dd id="result">此次宣泄结果不是很成功，请再次击打呐喊宣泄。您必须以积极的心理适应环境，增强个体在社会中的适应性；也要分析自我的性格特点，从而更好的认识自我，提高自我，生活本身就是一个学习的过程，相信自己，请加油！</dd>
                     </dl>
                 </li>
                 <li class="list-group-item">
                     <dl class="dl-horizontal">
                         <dt>指导建议：</dt>
                         <dd id="suggest">培养积极的心态是应对压力的良方，即使你现在不尽如意，你还是应该把握住机会，在历史的面前，做到尽吾志，莫道错过的时候，才后悔万分，这样的人生，必定是失败和苍白的人生。每个人都知道心态很重要，但更重要的是要明白如何调节心态，积极地调集能动性，改善心境，调整心态，改善自身状态，这样才能以自变（改变自我），而应万变拥有良好和积极的心态再配以良方技巧一定能够解决，人生赢家赢在明天！</dd>
                     </dl>
                 </li>

             </ul>
         </div>
     </div>
     <div class="panel " >
         <div class="panel-heading ">解决压力的方法 </div>
         <div class="panel-body">
           <p>1、注重过程淡化功利法</p>
           <p>建立合理的、客观的自我期望值，奋斗目标要合理，有时做事可往最坏处着想，但向最好处努力。</p>
           <p>2、换位思考认同法</p>
           <p>正确认知压力，灵活调整自己的心态。例如，当你遇到不公平的事情、不协调的人际关系、不愉快的情感体验时，试试换位思考。</p>
           <p>3、音乐与生理保健法</p>
           <p>各种声音通过耳朵被人感受，如他人的赞扬声、指责声、议论声等都会影响你的心态，因此，你可以多听些优美的音乐，缓解不愉快的心情。养成良好的生活与自我保健行为习惯极为重要，同时，创造和谐的家庭氛围更不容忽视。</p>
           <p>4、推移时间遗忘法</p>
           <p>时间是解决问题的最好办法，积极忘记过去的、眼前的不愉快，随时修正自己的认知观念，不要让痛苦的过去牵制住你的未来。</p>
           <p>5、自信自主激励法</p>
           <p>即相信自己是最好的、最可以依赖的，每桩伟业都由自信开始。</p>
           <p>6、顺其自然自我解脱法</p>
           <p>学会自我放松，在适当的情况下，找信得过的人想说便说;想休息便休息;想娱乐便娱乐，实在不想做事时可暂时放下，可以追求卓越，但无需求十全十美。</p>
         </div>
     </div>

     <div style="text-align: center; margin-top: 20px;"   >
     	<a class="btn btn-lg btn-danger" href="recommend_game1.html">推荐游戏</a>
     	<a class="btn btn-lg btn-danger" href="recommend_music.html">推荐音乐</a>
         <!--<a href="javascript:history.go(-1)" class="btn btn-lg btn-danger"> <i class="iconfont icon-tuichu"></i> 返回</a>-->
     </div>
     <div class="row">
         <div class="text-right">
             <button type="button" class="btn btn-lg btn-default " onclick="daochu()"> <i class="iconfont icon-xiazai"></i> 导出</button>
         </div>
     </div>
</div>
</div>
<span class="close">&times;</span>
<script type="text/javascript">

    // 第一个
    var number="";
    var name="";
    var sex="";
    var date="";
    var xueli="";
    var minzu="";
    var youxiu=333;
    var lianghao=245;
    var hege=231;
    var buhege=145;
    var jidayouxiu=11;
    var jidahege=6;
    var jidabuhege=2;
    var nahanyouxiu=4;
    var nahanhege=3;
    var nahanbuhege=5;
    var jidanahanyouxiu=4;
    var jidanahanhege=8;
    var jidanahanbuhege=5;
    var yongbaoyouxiu=5;
    var yongbaohege=9;
    var yongbaobuhege=2;
    var qResult="";
    var jidacishu=50;
    var xuanxiecishu=40;
    var result;
    var suggest;
    var xuanxiedate;



    if((jidacishu+xuanxiecishu)<50){
        result="此次宣泄结果不是很成功，请再次进行宣泄。您必须以积极的心理适应环境，增强个体在社会中的适应性；也要分析自我的性格特点，从而更好的认识自我，提高自我，生活本身就是一个学习的过程，相信自己，请加油！";
        suggest=" 培养积极的心态是应对压力的良方，即使你现在不尽如意，你还是应该把握住机会，在历史的面前，做到尽吾志，莫道错过的时候，才后悔万分，这样的人生，必定是失败和苍白的人生。每个人都知道心态很重要，但更重要的是要明白如何调节心态，积极地调集能动性，改善心境，调整心态，改善自身状态，这样才能以自变（改变自我），而应万变拥有良好和积极的心态再配以良方技巧一定能够解决，人生赢家赢在明天！";
    }
    else if((jidacishu+xuanxiecishu)<100){
        result="此次宣泄结果不错，您的内心压力释放了很多，请继续加油。您可以通过本系统的游戏模块或学习模块继续提高宣泄效果，达到更好的压力释放。";
        suggest="通过积极宣泄内心的压力释放了很多，你很棒，也很勇敢，大多数人都想改变这个世界，但没有想改变自己。有时候,我们改变不了我们周围的环境,可是我们却可以改变自己,改变自己看待周围环境的心态以及目光,“你周围的人如此和蔼，你周围的环境是如此的美丽，你有如此优点和能力去适应新环境。”整理自己的心情，到了那个时候,你会发现其实身边每一样事物看上去都是那么美好,那么环境不就是已经改变了，不是吗?";
    }
    else{
        result="此次宣泄结果非常成功，在工作、生活、学习中，或多或少都会遇到这样那样问题，不顺心或不愉快，请不要将各种压力因素长久的压在内心里，找亲人朋友倾述或找个自己热爱的运动去放松一下。这样，我们才能以更好的心态去工作生活学习！";
        suggest="你的压力已经释放了很多，是不是很舒服，你还要转变信念，才能更好的应对压力，你一定要深信，事情总能朝着所期望的方向发展，以最乐观的心情想象最好的结果。只要努力，需要做的所有事都已经在进展当中，其实那些优秀人士并不是比我们能力强很多，而是遇到麻烦，也一定会以最快的速度重新调整状态，尽快解决，所以你要做这样的人，面对压力迅速调整自己，以最好的状态应对压力。";
    }
    var myDate = new Date();
    xuanxiedate=myDate.toLocaleDateString();
    document.getElementById("jidatime").innerText=jidacishu;
    document.getElementById("xuanxietime").innerText=xuanxiecishu;
    document.getElementById("result").innerText=result;
    document.getElementById("suggest").innerText=suggest;

    $.get("php/getuser.php" ,function (data){
        var temp=data.split("\n");
        var temp1=temp[temp.length-1].split(" ");
        number=temp1[1];
        name=temp1[2];
        date=temp1[3];
        sex=temp1[4];
        xueli=temp1[5];
        minzu=temp1[6];
        document.getElementById("number").innerText=number;
        document.getElementById("name").innerText=name;
        document.getElementById("date").innerText=date;
        document.getElementById("sex").innerText=sex;
        document.getElementById("xueli").innerText=xueli;
        document.getElementById("minzu").innerText=minzu;
		var storage=window.localStorage;
		if(storage['type']=='other'){
          $.get("php/getresult.php" ,async =false,function (data) {
            var temp = data.split("  ");
            qResult=temp[1];
            document.getElementById("qResult").innerText=qResult;
			
            if(storage['has']=='yes'){
               $.post("php/addxuanxie.php" ,{number:number,name:name,sex:sex,date:date,xueli:xueli,minzu:minzu,youxiu:youxiu,lianghao:lianghao,hege:hege,buhege:buhege,jidayouxiu:jidayouxiu,jidahege:jidahege,jidabuhege:jidabuhege,nahanyouxiu:nahanyouxiu,nahanhege:nahanhege,nahanbuhege:nahanbuhege,jidanahanyouxiu:jidanahanyouxiu,jidanahanhege:jidanahanhege,jidanahanbuhege:jidanahanbuhege,yongbaoyouxiu:yongbaoyouxiu,yongbaohege:yongbaohege,yongbaobuhege:yongbaobuhege,qResult:qResult,jidacishu:jidacishu,xuanxiecishu:xuanxiecishu,result:result,suggest:suggest,xuanxiedate:xuanxiedate},function (data) {
               })
			}
          })
		}
		else{
		    qResult="快速宣泄无测试结果";
		    document.getElementById("qResult").innerText=qResult;
			
            if(storage['has']=='yes'){
               $.post("php/addxuanxie.php" ,{number:number,name:name,sex:sex,date:date,xueli:xueli,minzu:minzu,youxiu:youxiu,lianghao:lianghao,hege:hege,buhege:buhege,jidayouxiu:jidayouxiu,jidahege:jidahege,jidabuhege:jidabuhege,nahanyouxiu:nahanyouxiu,nahanhege:nahanhege,nahanbuhege:nahanbuhege,jidanahanyouxiu:jidanahanyouxiu,jidanahanhege:jidanahanhege,jidanahanbuhege:jidanahanbuhege,yongbaoyouxiu:yongbaoyouxiu,yongbaohege:yongbaohege,yongbaobuhege:yongbaobuhege,qResult:qResult,jidacishu:jidacishu,xuanxiecishu:xuanxiecishu,result:result,suggest:suggest,xuanxiedate:xuanxiedate},function (data) {
               })
			}
		}
    })






    var myChart1 = echarts.init(document.getElementById('eChart1'));
    var    data=[
        {value:youxiu, name:'优秀'},
        {value:lianghao, name:'良好'},
        {value:hege, name:'合格'},
        {value:buhege, name:'不合格'},
    ];

    var totalN=0;

    for(var i=0;i<data.length;i++){
        totalN+=data[i].value;
    }

    option1 = {
        /*   title : {
         text: '同名数量统计',
         subtext: '纯属虚构',
         x:'center'
         },*/
        tooltip : {
            trigger: 'item',
            formatter: "{a} <br/>{b} : {c} ({d}%)"
        },
        legend: {
            orient: 'vertical',
            left: 'right',
            top:'40%',
            textStyle:{
                fontSize:12
            },
            data: ['优秀',
                '良好',
                '合格',
                '不合格',],
        },
        // xAxis:{
        //     nameTextStyle:{
        //        fontSize:'34',
        //     }
        // },
        series : [
            {
                name: '访问来源',
                type: 'pie',
                radius : '60%',
                center: ['50%', '50%'],
                data:[{value:youxiu, name:'优秀'},
                    {value:lianghao, name:'良好'},
                    {value:hege, name:'合格'},
                    {value:buhege, name:'不合格',},
                ],
                itemStyle: {
                    emphasis: {
                        shadowBlur: 10,
                        shadowOffsetX: 0,
                        shadowColor: 'rgba(0, 0, 0, 0.5)'
                    },
                    normal: {
                        color: function(params) {
                            // build a color map as your need.
                            var colorList = [
                                '#FD6F17','#33E37D','#04B9DF','#EAD700'
                            ];
                            return colorList[params.dataIndex]
                        }
                    }
                },
                labelLine: {
                    normal: {
                        smooth: 0.4,

                    }
                },
                label: {
                    normal: {
                        textStyle: {

                            fontSize:'12',

                        }
                    }
                },
            }
        ]
    };
    myChart1.setOption(option1);

//    第二个
    var myChart2 = echarts.init(document.getElementById('eChart2'));
    option2 = {
      /*  title : {
            text: '某地区蒸发量和降水量',
            subtext: '纯属虚构'
        },*/
        tooltip : {
            trigger: 'axis'
        },
        legend: {
            data:['数据一','数据二','数据三']
        },

        calculable : true,
        xAxis : [
            {
                type : 'category',
                data : ['击打','呐喊','击打呐喊','拥抱']
            }
        ],
        yAxis : [
            {
                type : 'value'
            }
        ],
        series : [
            {
                name:'优秀',
                type:'bar',
                data:[jidayouxiu, nahanyouxiu, jidanahanyouxiu, yongbaoyouxiu],
            },
            {
                name:'合格',
                type:'bar',
                data:[jidahege,nahanhege,jidanahanhege,yongbaohege],
            },
            {
                name:'不合格',
                type:'bar',
                data:[jidabuhege,nahanbuhege,jidanahanbuhege,yongbaobuhege],
            },
        ]
    };
    myChart2.setOption(option2);

    $.get("php/getmessage.php" ,async =false,function (data){
        var temp=data.split("\n");
        var temp1=temp[temp.length-1];
        var q=temp1.split("...");
        document.getElementById("title").innerText=q[0];
    })
function daochu(){
    /*复制元素，注意ID*/
    window.location.href="#";
    $("body").append('<div id="pdf1">…………………………………………………………</div>');
    /*设置新元素样式*/
    $("#pdf1").css({
        "background-color": "#fff",
        "position": "absolute",
        "top": "0px",
        "z-index": "-1",
        "height": $("#pdf1").height()
    });
    /*html2canvas生成图片，jspdf生成PDF文件*/
    html2canvas($("#pdf1"), {
        background: "#fff",
        allowTaint: true,
        taintTest: false,
        onrendered:function(canvas) {
            var contentWidth = canvas.width;
            var contentHeight = canvas.height;
            var pageHeight = contentWidth / 592.28 * 841.89;
            var leftHeight = contentHeight;
            var position = 0;
            var imgWidth = 595.28;
            var imgHeight = 592.28/contentWidth * contentHeight;
            var pageData = canvas.toDataURL('image/jpeg', 1.0);
            var img = new Image();
            img.src = pageData;
            var pdf = new jsPDF('p', 'pt', 'a4');
            img.onload = function() {
                if (leftHeight < pageHeight) {
                    pdf.addImage(pageData, 'JPEG', 0, 0, imgWidth, imgHeight );
                } else {
                    while(leftHeight > 0) {
                        pdf.addImage(pageData, 'JPEG', 0, position, imgWidth, imgHeight)
                        leftHeight -= pageHeight;
                        position -= 841.89;
                        if(leftHeight > 0) {
                            pdf.addPage();
                        }
                    }
                }
                pdf.save(new Date().getTime() + '宣泄结果.pdf');
                //$("#pdf1").remove();
                window.location.href="trainingResult.html";
            }
        },
    })
}

    function inittheme(id){
        if(id==0){
            $("body").css({
                "background":'url(../record/background/background.jpg) no-repeat',
                "background-size":"cover",
                "background-position":"center center",
            });
        }
        else {
            $("body").css({
                "background": 'url(images/bg_' + id + '.jpg) no-repeat',
                "background-size": "cover",
                "background-position": "center center",
            });
        }
    }
    var storage=window.localStorage;
    if(storage['has']=='yes'){
        $.get("php/getbackground.php",function (data) {
            var temp = data.split("\n");
            var temp1 = temp[temp.length - 1];
            inittheme(parseInt(temp1));
        })
    }
    else{
        $.get("php/getmessage.php" ,async =false,function (data){
            var temp=data.split("\n");
            var temp1=temp[temp.length-1];
            var q=temp1.split("...");
            $("body").css({
                "background": 'url(../' + q[3] + ') no-repeat',
                "background-size": "cover",
                "background-position": "center center",
            });
        })
    }
    $.get("php/getmessage.php" ,async =false,function (data){
        var temp=data.split("\n");
        var temp1=temp[temp.length-1];
        var q=temp1.split("...");
        document.getElementById("title").innerText=q[0];
        document.getElementById("t2").innerText=q[0];
        $("body").css({
            "background": 'url(../' + q[3] + ') no-repeat',
            "background-size": "cover",
            "background-position": "center center",
        });
    })
</script>
</div>
</body>

</html>